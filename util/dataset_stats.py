from pathlib import Path
from os.path import join
import pydicom
# from l3finder.ingest import *

ds_path = Path(r"\\vnas1\root1\Radiology\SHARED\Elan\Projects\Skeletal Muscle Project\combined_dataset")
print(ds_path.exists())

# >>> subjects = list(ds_path.iterdir())
# >>> assencions = [list(s.iterdir()) for s in subjects]
# >>> flatten = lambda l: [item for sublist in l for item in sublist]
# >>> accessions = flatten(assencions)
# series = [list(a.iterdir()) for a in accesssions]
# Traceback (most recent call last):
#   File "<input>", line 1, in <module>
# NameError: name 'accesssions' is not defined
# series = [list(a.iterdir()) for a in accessions]
# len(series)
# 379
# missing_or_extra = []
# for i, s in enumerate(series):
# ...    if len(s) != 2:
# ...        missing_or_extra.append((i+1, s))
# ...
# missing_or_extra
# [(4, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_101-20190044_101/ST-11192018-20190044_101CT_ABDOMEN_PELVIS_W_CONTRAST/IM-CT-60-zaLnQ0Sj1gg.dcm'), WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_101-20190044_101/ST-11192018-20190044_101CT_ABDOMEN_PELVIS_W_CONTRAST/SE-2-Stnd_Pediatric_5.0_CE'), WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_101-20190044_101/ST-11192018-20190044_101CT_ABDOMEN_PELVIS_W_CONTRAST/SE-5-Stnd_Pediatric_3.0_CE')]), (104, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_196-20190044_196/ST-11122018-20190044_196CT_ABDOMEN_PELVIS_W_CONTRAST/SE-4-Body_Std._Axial_AIDR_-_H__5.0')]), (106, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_2-20190044_2/ST-10302018-20190044_2CT_ABDOMEN_PELVIS_W_CONTRAST/SE-4-Body_Std._Axial_AIDR_-_H_Axial_3.000')]), (108, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_200-20190044_200/ST-09292018-20190044_200CT_ABDOMEN_PELVIS_W_CONTRAST/SE-4-Body_Std._Axial_AIDR_-_H_Axial_3.000'), WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_200-20190044_200/ST-09292018-20190044_200CT_ABDOMEN_PELVIS_W_CONTRAST/SE-6-Body_Std._Axial_AIDR_-_H_Sagittal_3.000'), WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_200-20190044_200/ST-09292018-20190044_200CT_ABDOMEN_PELVIS_W_CONTRAST/test')]), (111, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_204-20190044_204/ST-09202016-20190044_204CT_ABDOMEN_PELVIS_W_CONTRAST/SE-4-Axial_Body_Axial_3.000')]), (123, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_215-20190044_215/ST-11062015-20190044_215CT_ABDOMEN_PELVIS_W_CONTRAST/SE-4-Axial_Body_Axial_3.000')]), (156, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_245-20190044_245/ST-10142016-20190044_245CT_ABDOMEN_PELVIS_W_CONTRAST/SE-2-Axial_Body__5.0')]), (208, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_293-20190044_293/ST-09102011-20190044_293CT_ABDOMEN_PELVIS_W_CONTRAST/SE-9-Sagittal_Sagittal_3.0_CE')]), (211, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_296-20190044_296/ST-10102015-20190044_296CT_ABDOMEN_PELVIS_W_CONTRAST/SE-5-Axial_Body__5.0')]), (229, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_311-20190044_311/ST-01142015-20190044_311CT_ABDOMEN_PELVIS_W_CONTRAST/SE-6-Sagittal_Body_Sagittal_3.000')]), (235, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_317-20190044_317/ST-02022016-20190044_317CT_ABDOMEN_PELVIS_W_CONTRAST/SE-2-Axial_Body__5.0')]), (241, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_322-20190044_322/ST-03302015-20190044_322CT_CHEST_ABDOMEN_PELVIS_W_CONTRAST/SE-2-Axial_Body__5.0')]), (244, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_325-20190044_325/ST-02162017-20190044_325CT_ABDOMEN_PELVIS_W_CONTRAST/SE-6-Axial_Body__5.0')]), (247, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_328-20190044_328/ST-01282018-20190044_328CT_ABDOMEN_PELVIS_W_CONTRAST/SE-5-Body_Std._Axial_AIDR_-_H_Vol._0.5')]), (259, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_339-20190044_339/ST-10192014-20190044_339CT_ABDOMEN_PELVIS_W_CONTRAST/SE-5-Axial_Body__5.0')]), (265, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_344-20190044_344/ST-04222016-20190044_344CT_ABDOMEN_PELVIS_W_CONTRAST/SE-5-Axial_Body__5.0')]), (272, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_350-20190044_350/ST-10012018-20190044_350CT_ABDOMEN_PELVIS_W_CONTRAST/SE-4-Body_Std._Axial_AIDR_-_H_Coronal_3.000')]), (282, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_36-20190044_36/ST-10242018-20190044_36CT_CHEST_W_CONTRAST/SE-6-ABD_PEL_ONLY_FOR_DMPR')]), (377, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_97-20190044_97/ST-12172018-20190044_97CT_ABDOMEN_PELVIS_W_CONTRAST/SE-2-Body_Std._Axial_AIDR_-_H__5.0')])]
# len(missing_or_extra)
# 19
# for s in missing_or_extra:
# ...    print(s)
# ...
# (4, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_101-20190044_101/ST-11192018-20190044_101CT_ABDOMEN_PELVIS_W_CONTRAST/IM-CT-60-zaLnQ0Sj1gg.dcm'), WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_101-20190044_101/ST-11192018-20190044_101CT_ABDOMEN_PELVIS_W_CONTRAST/SE-2-Stnd_Pediatric_5.0_CE'), WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_101-20190044_101/ST-11192018-20190044_101CT_ABDOMEN_PELVIS_W_CONTRAST/SE-5-Stnd_Pediatric_3.0_CE')])
# (104, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_196-20190044_196/ST-11122018-20190044_196CT_ABDOMEN_PELVIS_W_CONTRAST/SE-4-Body_Std._Axial_AIDR_-_H__5.0')])
# (106, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_2-20190044_2/ST-10302018-20190044_2CT_ABDOMEN_PELVIS_W_CONTRAST/SE-4-Body_Std._Axial_AIDR_-_H_Axial_3.000')])
# (108, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_200-20190044_200/ST-09292018-20190044_200CT_ABDOMEN_PELVIS_W_CONTRAST/SE-4-Body_Std._Axial_AIDR_-_H_Axial_3.000'), WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_200-20190044_200/ST-09292018-20190044_200CT_ABDOMEN_PELVIS_W_CONTRAST/SE-6-Body_Std._Axial_AIDR_-_H_Sagittal_3.000'), WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_200-20190044_200/ST-09292018-20190044_200CT_ABDOMEN_PELVIS_W_CONTRAST/test')])
# (111, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_204-20190044_204/ST-09202016-20190044_204CT_ABDOMEN_PELVIS_W_CONTRAST/SE-4-Axial_Body_Axial_3.000')])
# (123, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_215-20190044_215/ST-11062015-20190044_215CT_ABDOMEN_PELVIS_W_CONTRAST/SE-4-Axial_Body_Axial_3.000')])
# (156, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_245-20190044_245/ST-10142016-20190044_245CT_ABDOMEN_PELVIS_W_CONTRAST/SE-2-Axial_Body__5.0')])
# (208, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_293-20190044_293/ST-09102011-20190044_293CT_ABDOMEN_PELVIS_W_CONTRAST/SE-9-Sagittal_Sagittal_3.0_CE')])
# (211, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_296-20190044_296/ST-10102015-20190044_296CT_ABDOMEN_PELVIS_W_CONTRAST/SE-5-Axial_Body__5.0')])
# (229, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_311-20190044_311/ST-01142015-20190044_311CT_ABDOMEN_PELVIS_W_CONTRAST/SE-6-Sagittal_Body_Sagittal_3.000')])
# (235, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_317-20190044_317/ST-02022016-20190044_317CT_ABDOMEN_PELVIS_W_CONTRAST/SE-2-Axial_Body__5.0')])
# (241, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_322-20190044_322/ST-03302015-20190044_322CT_CHEST_ABDOMEN_PELVIS_W_CONTRAST/SE-2-Axial_Body__5.0')])
# (244, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_325-20190044_325/ST-02162017-20190044_325CT_ABDOMEN_PELVIS_W_CONTRAST/SE-6-Axial_Body__5.0')])
# (247, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_328-20190044_328/ST-01282018-20190044_328CT_ABDOMEN_PELVIS_W_CONTRAST/SE-5-Body_Std._Axial_AIDR_-_H_Vol._0.5')])
# (259, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_339-20190044_339/ST-10192014-20190044_339CT_ABDOMEN_PELVIS_W_CONTRAST/SE-5-Axial_Body__5.0')])
# (265, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_344-20190044_344/ST-04222016-20190044_344CT_ABDOMEN_PELVIS_W_CONTRAST/SE-5-Axial_Body__5.0')])
# (272, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_350-20190044_350/ST-10012018-20190044_350CT_ABDOMEN_PELVIS_W_CONTRAST/SE-4-Body_Std._Axial_AIDR_-_H_Coronal_3.000')])
# (282, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_36-20190044_36/ST-10242018-20190044_36CT_CHEST_W_CONTRAST/SE-6-ABD_PEL_ONLY_FOR_DMPR')])
# (377, [WindowsPath('//vnas1/root1/Radiology/SHARED/Elan/Projects/Skeletal Muscle Project/combined_dataset/PT-20190044_97-20190044_97/ST-12172018-20190044_97CT_ABDOMEN_PELVIS_W_CONTRAST/SE-2-Body_Std._Axial_AIDR_-_H__5.0')])
